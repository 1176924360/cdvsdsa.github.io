<!DOCTYPE html>
<html>
  <head><meta name="generator" content="Hexo 3.8.0">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    
    
    <meta name="keywords" content="Life, ARIA, Hexo, Java">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/clipboard.min.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "search.xml";
      if (searchPath.length === 0) {
        searchPath = "search.xml";
      }
      var path = "/" + searchPath;
      searchFunc(path, "search-input", "search-result");
    });
    </script>
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var cb = null;
      var els = $(".post figure.highlight");
      if (els.length) {
        // Enabled Hexo highlight line number.
        $(els).each(function (i, e) {
          $(e).before("<button class=\"copy button\">å¤åˆ¶</button>");
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              // nextElementSibling is figure,highlight.
              // And following is the sequence of Hexo's internal
              // highlight layout with line number.
              return trigger.nextElementSibling.firstChild.firstChild.firstChild.lastChild.firstChild.firstChild;
          }
        });
      } else {
        // Disabled Hexo highlight line number.
        els = $(".post pre code");
        $(els).each(function (i, e) {
          // Add button before pre, not code.
          $(e).parent().before("<button class=\"copy button\">å¤åˆ¶</button>");
        });
        cb = new ClipboardJS("button.copy", {
          "target": function (trigger) {
              // Get target element by DOM API.
              // nextElementSibling is figure,highlight.
              // And following is the sequence of Hexo's internal
              // highlight layout without line number.
              return trigger.nextElementSibling.firstChild;
          }
        });
      }
      cb.on("success", function (e) {
        e.clearSelection();
        var trigger = e.trigger;
        // Change button text as a user tip.
        trigger.innerHTML = "å·²å¤åˆ¶";
        $(trigger).addClass("copied");
        // Change button text back;
        setTimeout(function () {
          trigger.innerHTML = "å¤åˆ¶";
          $(trigger).removeClass("copied");
        }, 1500);
      });
    });
    </script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>
    <title>MySQL_å­¦ä¹ day04 | Hexo</title>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage" lang="default" data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header" style="background: #33363b;">
  <div class="container">
    <div class="header-container">
      <div class="header-title">
        <h1 class="title"><a href="/">Hexo</a></h1>
        <h2 class="subtitle"></h2>
      </div>
      
      <div class="logo">
        <img src="/images/logo.png" alt="logo">
      </div>
      
    </div>
    <nav id="nav" class="nav">
      <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="åˆ‡æ¢å¯¼èˆªæ "></i></a>
      <ul id="menu" role="menubar" aria-hidden="false">
        
        <li role="menuitem"><a href="/"><i class="fas fa-home"></i><span class="menu-text">é¦–é¡µ</span></a></li>
        
        <li role="menuitem"><a href="/archives/"><i class="fas fa-archive"></i><span class="menu-text">å½’æ¡£</span></a></li>
        
      </ul>
    </nav>
  </div>
</header>


    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="page">
  
  <article class="article post card" itemscope itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/06/10/MySQL-å­¦ä¹ day04/">
      <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
       <meta itemprop="name" content="å˜¤å˜¤æ€ª&&ğŸ¶">
       <meta itemprop="description" content>
       <meta itemprop="image" content="/images/blog.jpg">
      </span>
      <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
       <meta itemprop="name" content="Hexo">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">MySQL_å­¦ä¹ day04</h1>
      <div class="post-meta">
        
        <span class="post-date">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2019-06-10T10:17:42+08:00">2019-06-10 10:17:42</time></span>
        </span>
        
        
        
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <h2 id="MySQLæŸ¥è¯¢ä¼˜åŒ–"><a href="#MySQLæŸ¥è¯¢ä¼˜åŒ–" class="headerlink" title="MySQLæŸ¥è¯¢ä¼˜åŒ–"></a>MySQLæŸ¥è¯¢ä¼˜åŒ–</h2><h3 id="inä¸exists"><a href="#inä¸exists" class="headerlink" title="inä¸exists"></a>inä¸exists</h3><p>æ°¸è¿œå°è¡¨é©±åŠ¨å¤§è¡¨ï¼Œç±»ä¼¼åµŒå¥—å¾ªç¯Nested Loopï¼Œå³å°çš„æ•°æ®é›†é©±åŠ¨å¤§çš„æ•°æ®é›†(RBOåŸç†)</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from A where id in(select id from B);<br></code></pre></td></tr></table></figure>
<p>ç­‰ä»·äº</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">for select id from B<br>		for select * from A where A.id = B.id;<br></code></pre></td></tr></table></figure>
<a id="more"></a>
<p>å½“Bè¡¨çš„æ•°æ®é›†å¿…é¡»å°äºAè¡¨çš„æ•°æ®é›†æ—¶ï¼Œç”¨inä¼˜äºexists</p>
<p>existsç”¨æ³•ï¼š select â€¦ from table where exists(subquery)å°†ä¸»æŸ¥è¯¢çš„æ•°æ®æ”¾åˆ°å­æŸ¥è¯¢ä¸­åšæ¡ä»¶éªŒè¯ï¼Œæ ¹æ®éªŒè¯ç»“æœå†³å®šä¸»æŸ¥è¯¢çš„æ•°æ®ç»“æœæ˜¯å¦å¾—ä»¥ä¿ç•™ï¼Œsubqueryåªè¿”å›trueå’Œfalseï¼Œå› æ­¤existsä¸­çš„æŸ¥è¯¢å¯ä»¥å†™ä¸ºselect 1æˆ–å…¶ä»–</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">select * from A where exsits(select 1 from B where B.id = A.id);<br></code></pre></td></tr></table></figure>
<p>ç­‰ä»·äº</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">for select * from A<br>		for select * from B where B.id = A.id;<br></code></pre></td></tr></table></figure>
<p>å½“Aè¡¨çš„æ•°æ®é›†å°äºBè¡¨çš„æ•°æ®é›†æ—¶ï¼Œç”¨existsç”±ä¼˜äºin</p>
<p>ä¾‹å­ï¼š</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SELECT * FROM emp e WHERE e.deptId IN(SELECT id FROM dept d);<br>SELECT * FROM emp e WHERE EXISTS(SELECT 1 FROM dept d WHERE d.id = e.deptId);<br></code></pre></td></tr></table></figure>
<p>ä¸Šé¢çš„sqlæ˜¯ç”¨inå…³é”®è¯ï¼Œä¸‹é¢çš„sqlæ˜¯ä½¿ç”¨existså…³é”®è¯ï¼Œè¿™ä¸¤ä¸ªè¯­å¥å¾—åˆ°çš„ç»“æœéƒ½ä¸€æ ·</p>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610134919.png" alt="ç»“æœ"><br>ä½¿ç”¨inå…³é”®è¯çš„sqlè¯­å¥ï¼Œempè¡¨é©±åŠ¨deptè¡¨ï¼›ä½¿ç”¨existså…³é”®è¯çš„sqlè¯­å¥ï¼Œdeptè¡¨é©±åŠ¨empè¡¨ã€‚</p>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610134453.png" alt="empè¡¨"><br><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610142158.png" alt="deptè¡¨"><br>å¯ä»¥çœ‹å‡ºempæ˜¯å¤§è¡¨ï¼Œdeptæ˜¯å°è¡¨ï¼Œæ ¹æ®å°è¡¨é©±åŠ¨å¤§è¡¨çš„åŸåˆ™ï¼Œdeptè¡¨é©±åŠ¨empè¡¨ï¼Œå…¶explainç»“æœ</p>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610143405.png" alt="inçš„ç»“æœ"><br>å…¶deptè¡¨çš„typeä¸ºunique_subquery</p>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610143520.png" alt="existsçš„ç»“æœ"><br>å…¶deptè¡¨çš„typeä¸ºeq_ref<br>ä½¿ç”¨existsçš„ç»“æœæ¯”ä½¿ç”¨inçš„ç»“æœå¥½</p>
<h3 id="order-byå…³é”®å­—ä¼˜åŒ–"><a href="#order-byå…³é”®å­—ä¼˜åŒ–" class="headerlink" title="order byå…³é”®å­—ä¼˜åŒ–"></a>order byå…³é”®å­—ä¼˜åŒ–</h3><p>Order byæ—¶select *æ˜¯ä¸€ä¸ªå¤§å¿Œï¼ŒåªQueryéœ€è¦çš„å­—æ®µ<br>order byå­å¥ï¼Œå°½é‡ä½¿ç”¨indexæ–¹å¼æ’åºï¼Œé¿å…ä½¿ç”¨FileSortæ–¹å¼æ’åºã€‚MySQLæ”¯æŒä¸¤ç§æ’åºæ–¹å¼ï¼ŒFileSortå’ŒIndexï¼ŒIndexæ•ˆç‡é«˜ï¼Œå®ƒæŒ‡MySQLæ‰«æç´¢å¼•æœ¬èº«å®Œæˆæ’åºã€‚FileSortæ–¹å¼æ•ˆç‡ä½ã€‚<br>Order Byæ»¡è¶³ä¸¤ç§æƒ…å†µï¼Œä¼šä½¿ç”¨Indexæ–¹å¼æ’åº</p>
<ul>
<li>order byè¯­å¥ä½¿ç”¨ç´¢å¼•æœ€å·¦å‰åˆ—</li>
<li>ä½¿ç”¨whereå­å¥ä¸order byå­å¥æ¡ä»¶åˆ—ç»„åˆæ»¡è¶³æœ€å·¦å‰åˆ—</li>
</ul>
<p>å°½å¯èƒ½åœ¨ç´¢å¼•åˆ—ä¸Šå®Œæˆæ’åºæ“ä½œï¼Œéµç…§ç´¢å¼•å»ºçš„æœ€ä½³å·¦å‰ç¼€ï¼Œå¦‚æœä¸åœ¨ç´¢å¼•åˆ—ä¸Šï¼Œfilesortæœ‰ä¸¤ç§ç®—æ³•ï¼Œmysqlå°±è¦å¯åŠ¨åŒè·¯æ’åºå’Œå•è·¯æ’åº</p>
<ul>
<li>åŒè·¯æ’åºï¼šMySQL4.1ä¹‹å‰æ˜¯ä½¿ç”¨åŒè·¯æ’åºï¼Œå­—é¢æ„æ€å°±æ˜¯ä¸¤æ¬¡æ‰«æç£ç›˜ï¼Œæœ€ç»ˆå¾—åˆ°æ•°æ®ï¼Œè¯»å–è¡ŒæŒ‡é’ˆå’Œorder byåˆ—ï¼Œå¯¹ä»–ä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«æå·²ç»æ’åºå¥½çš„åˆ—è¡¨ï¼ŒæŒ‰ç…§åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­çš„å€¼é‡æ–°ä»åˆ—è¡¨ä¸­è¯»å–å¯¹åº”çš„æ•°æ®è¾“å‡ºä»ç£ç›˜å–æ’åºå­—æ®µï¼Œåœ¨bufferè¿›è¡Œæ’åºï¼Œå†ä»ç£ç›˜å–å…¶ä»–å­—æ®µ</li>
<li>å•è·¯æ’åºï¼šä»ç£ç›˜è¯»å–æŸ¥è¯¢éœ€è¦çš„åˆ—ï¼ŒæŒ‰ç…§order byåˆ—åœ¨bufferå¯¹ä»–ä»¬è¿›è¡Œæ’åºï¼Œç„¶åæ‰«ææ’åºåçš„åˆ—è¡¨è¿›è¡Œè¾“å‡ºï¼Œå®ƒæ•ˆç‡æ›´å¿«ä¸€äº›ï¼Œé¿å…äº†ç¬¬äºŒæ¬¡è¯»å–æ•°æ®ã€‚å¹¶ä¸”æŠŠéšæœºIOå˜æˆäº†é¡ºåºIOï¼Œä½†æ˜¯å®ƒä¼šä½¿ç”¨æ›´å¤šå‘ç©ºé—´ï¼Œå› ä¸ºå®ƒæŠŠæ¯ä¸€è¡Œéƒ½ä¿å­˜åœ¨å†…å­˜ä¸­</li>
</ul>
<p>ç»“è®ºä»¥åŠå¼•ç”³çš„é—®é¢˜ï¼šç”±äºå•è·¯æ˜¯åå‡ºçš„ï¼Œæ€»ä½“è€Œè¨€å¥½è¿‡åŒè·¯ä½†æ˜¯å•è·¯æœ‰é—®é¢˜ï¼šåœ¨sort_bufferä¸­ï¼Œæ–¹æ³•äºŒæ¯”æ–¹æ³•ä¸€è¦å ç”¨å¾ˆå¤šçš„ç©ºé—´ï¼Œå› ä¸ºæ–¹æ³•äºŒæ˜¯æŠŠæ‰€æœ‰å­—æ®µéƒ½å–å‡ºæ¥ï¼Œæ‰€ä»¥æœ‰å¯èƒ½å–å‡ºæ•°æ®çš„å¤§å°è¶…å‡ºäº†sort_bufferçš„å®¹é‡ï¼Œå¯¼è‡´æ¯æ¬¡åªèƒ½å–sort_bufferå®¹é‡å¤§å°çš„æ•°æ®ï¼Œè¿›è¡Œæ’åº(åˆ›å»ºtmpæ–‡ä»¶ï¼Œå¤šè·¯åˆå¹¶)ï¼Œæ’åºå®Œåå†å–sort_bufferå®¹é‡å¤§å°ï¼Œâ€¦ï¼Œä»è€Œå¤šæ¬¡IOã€‚æœ¬æ¥åƒçœä¸€æ¬¡IOæ“ä½œï¼Œåè€Œå¯¼è‡´äº†å¤§é‡çš„IOæ“ä½œï¼Œåè€Œå¾—ä¸å¿å¤±<br>ä¼˜åŒ–ç­–ç•¥ï¼šå¢å¤§sort_buffer_sizeå‚æ•°è®¾ç½®ï¼›å¢å¤§max_length_for_sort_dataå‚æ•°çš„è®¾ç½®</p>
<p>ä¾‹å­ï¼š</p>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610144133.png" alt="tblaè¡¨"><br>ä¸ºå…¶ageä¸birthåŠ ç´¢å¼•</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">CREATE INDEX idx_A_ageBirth ON tblA(age,birth);<br></code></pre></td></tr></table></figure>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610144327.png" alt="ç´¢å¼•"><br>å¯¹ä»¥ä¸‹çš„sqlè¯­å¥è¿›è¡Œexplain</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs mysql">EXPLAIN SELECT * FROM tblA WHERE age &gt; 20 ORDER BY age;<br>EXPLAIN SELECT * FROM tblA WHERE age &gt; 20 ORDER BY age,birth;<br>EXPLAIN SELECT * FROM tblA WHERE age &gt; 20 ORDER BY birth;<br>EXPLAIN SELECT * FROM tblA WHERE age &gt; 20 ORDER BY birth,age;<br>EXPLAIN SELECT * FROM tblA ORDER BY birth;<br>EXPLAIN SELECT * FROM tblA ORDER BY age ASC,birth DESC;<br></code></pre></td></tr></table></figure>
<p>å‰ä¸¤æ¡sqlè¯­å¥æ²¡æœ‰å‡ºç°Using filesortï¼Œå…¶ä½™çš„sqléƒ½å‡ºç°äº†Using filesort</p>
<h3 id="group-byå…³é”®å­—ä¼˜åŒ–"><a href="#group-byå…³é”®å­—ä¼˜åŒ–" class="headerlink" title="group byå…³é”®å­—ä¼˜åŒ–"></a>group byå…³é”®å­—ä¼˜åŒ–</h3><p>ä¸order byå‡ ä¹ä¸€è‡´<br>group byå®è´¨æ˜¯å…ˆæ’åºåè¿›è¡Œåˆ†ç»„ï¼ŒæŒ‰ç…§ç´¢å¼•é”®çš„æœ€ä½³å·¦å‰ç¼€<br>å½“æ— æ³•ä½¿ç”¨ç´¢å¼•åˆ—ï¼Œå¢å¤§max_length_for_sort_dataå‚æ•°çš„è®¾ç½®ï¼›å¢å¤§sor_buffer_sizeå‚æ•°çš„è®¾ç½®<br>whereé«˜äºhavingï¼Œèƒ½å†™åœ¨whereé™å®šçš„æ¡ä»¶å°±ä¸éœ€è¦havingé™å®š</p>
<h2 id="show-profileçš„ä½¿ç”¨"><a href="#show-profileçš„ä½¿ç”¨" class="headerlink" title="show profileçš„ä½¿ç”¨"></a>show profileçš„ä½¿ç”¨</h2><h3 id="æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·"><a href="#æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·" class="headerlink" title="æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·"></a>æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·</h3><p>1.æ˜¯ä»€ä¹ˆ<br>MySQLçš„æ…¢æŸ¥è¯¢æ—¥å¿—æ˜¯MySQLæä¾›çš„ä¸€ç§æ—¥å¿—è®°å½•ï¼Œå®ƒç”¨æ¥è®°å½•MySQLä¸­å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼çš„è¯­å¥ï¼Œå…·ä½“æŒ‡è¿è¡Œæ—¶é—´è¶…è¿‡long_query_timeçš„å€¼çš„SQLï¼Œåˆ™ä¼šè¢«è®°å½•åˆ°æ…¢æŸ¥è¯¢æ—¥å¿—ä¸­ï¼Œlong_query_timeçš„é»˜è®¤å€¼ä¸º10ï¼Œæ„æ€æ˜¯è¿è¡Œè¶…è¿‡10ç§’ä»¥ä¸Šçš„è¯­å¥ï¼Œç”±å®ƒæ¥æŸ¥çœ‹å“ªäº›SQLè¶…å‡ºäº†æˆ‘ä»¬çš„æœ€å¤§å¿è€çš„æ—¶é—´å€¼ï¼Œæ¯”å¦‚ä¸€æ¡sqlæ‰§è¡Œè¶…è¿‡5ç§’é’Ÿï¼Œå°±ç®—æ…¢SQLï¼Œå¸Œæœ›èƒ½æ”¶é›†è¶…è¿‡5ç§’çš„sqlï¼Œç»“åˆä¹‹å‰çš„explainè¿›è¡Œå…¨é¢çš„åˆ†æ</p>
<p>2.æ€ä¹ˆä½¿ç”¨<br>é»˜è®¤æƒ…å†µä¸‹ï¼ŒMySQLæ•°æ®åº“æ²¡æœ‰å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œéœ€è¦æ‰‹åŠ¨è®¾ç½®å‚æ•°<br><figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SHOW VARIABLES LIKE &apos;%slow_query_log%&apos;;<br></code></pre></td></tr></table></figure></p>
<p>æ­¤sqlå¯ä»¥æ˜¾ç¤ºæœ‰æ²¡æœ‰æ‰“å¼€æ—¥å¿—<br><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610150338.png" alt="ç»“æœ"><br>ç”±å›¾å¯çŸ¥ï¼Œæ—¥å¿—æ²¡æœ‰æ‰“å¼€ï¼Œä¸”æ—¥å¿—çš„ä½ç½®åœ¨cç›˜</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SET GLOBAL slow_query_log = 1;<br></code></pre></td></tr></table></figure>
<p>ä½¿ç”¨ä¸Šè¿°çš„sqlå¯ä»¥æ‰“å¼€æ—¥å¿—ï¼Œå¹¶åœ¨æ—¥å¿—ä¸­æ‰“å°è¶…è¿‡è®¾å®šæ—¶é—´long_query_timeå€¼çš„SQL    </p>
<h3 id="ä½¿ç”¨show-profile"><a href="#ä½¿ç”¨show-profile" class="headerlink" title="ä½¿ç”¨show profile"></a>ä½¿ç”¨show profile</h3><p>1.æ˜¯ä»€ä¹ˆ<br>æ˜¯MySQæä¾›å¯ä»¥ç”¨æ¥åˆ†æå½“å‰ä¼šè¯ä¸­è¯­å¥æ‰§è¡Œçš„èµ„æºæ¶ˆè€—æƒ…å†µï¼Œå¯ä»¥ç”¨äºSQLçš„è°ƒä¼˜æµ‹é‡ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå‚æ•°å¤„äºå…³é—­çŠ¶æ€ï¼Œå¹¶ä¿å­˜æœ€è¿‘15æ¬¡çš„è¿è¡Œç»“æœ</p>
<p>2.åˆ†ææ­¥éª¤</p>
<ul>
<li><p>æŸ¥çœ‹å½“å‰ç‰ˆæœ¬æ˜¯å¦æ”¯æŒ show variables like â€˜profilingâ€™;<br><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610152620.png" alt="ç»“æœ"><br>ç”±ä¸Šå›¾å¯çŸ¥ï¼Œæ­¤ç‰ˆæœ¬æ”¯æŒprofileï¼Œä¸”é»˜è®¤å…³é—­</p>
</li>
<li><p>å¼€å¯åŠŸèƒ½</p>
</li>
</ul>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">set profiling = on;<br></code></pre></td></tr></table></figure>
<ul>
<li>æŸ¥çœ‹ç»“æœ</li>
</ul>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SHOW profiles;<br></code></pre></td></tr></table></figure>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610152951.png" alt="ç»“æœ"><br>ä½¿ç”¨Query_IDçš„å€¼å¯ä»¥å¯¹å…·ä½“çš„ä¸€æ¡sqlè¯­å¥è¿›è¡Œåˆ†æï¼Œæ¯”å¦‚å¯¹17å·sqlè¯­å¥è¿›è¡Œåˆ†æ</p>
<figure class="hljs highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs mysql">SHOW profile cpu,block io FOR QUERY 17;<br></code></pre></td></tr></table></figure>
<p><img src="/2019/06/10/MySQL-å­¦ä¹ day04/QQæˆªå›¾20190610154732.png" alt="ç»“æœ"></p>
<ul>
<li>ç»“è®º<br>å‡ºç°ä»¥ä¸‹æƒ…å†µï¼Œä»£è¡¨sqlè¯­å¥éœ€è¦ä¼˜åŒ–<br>1.concerting HEAP to MyISAM æŸ¥è¯¢ç»“æœå¤ªå¤§ï¼Œå†…å­˜ä¸å¤Ÿç”¨ï¼Œå¾€ç£ç›˜ä¸Šæ¬<br>2.creating tmp table åˆ›å»ºä¸´æ—¶è¡¨ï¼Œæ‹·è´æ•°æ®åˆ°ä¸´æ—¶è¡¨ï¼Œç”¨å®Œååˆ é™¤<br>3.copying to tmp table on disk æŠŠå†…å­˜ä¸­ä¸´æ—¶è¡¨å¤åˆ¶åˆ°ç£ç›˜<br>4.locked</li>
</ul>

    </main>
    <footer class="post-footer">
      
    </footer>
  </article>
  
  
<div class="reward" id="reward">
  <p>å¸Œæœ›åœ¨å¸®åŠ©åˆ°è‡ªå·±çš„åŒæ—¶ä¹Ÿå¯ä»¥å¸®åŠ©ä½ ï¼</p>
  <button id="reward-button" class="button" disable="enable">æ‰“èµ</button>
  <div id="qr" class="qr" style="display: none;" aria-hidden="true">
    
    <div id="wechat">
      <img id="wechat_qr" src="/images/wx_ds.jpg" alt="å¾®ä¿¡æ”¯ä»˜">
      <span>å¾®ä¿¡æ”¯ä»˜</span>
    </div>
    
    
    
  </div>
</div>


  
  
  <nav class="page-nav">
    <div class="page-nav-next page-nav-item">
      
      <a href="/2019/06/04/MySQL-å­¦ä¹ day03/" rel="next" title="MySQL_å­¦ä¹ day03"><i class="fas fa-angle-left"></i><span class="nav-title">MySQL_å­¦ä¹ day03</span></a>
      
    </div>
    <div class="page-nav-prev page-nav-item">
      
    </div>
  </nav>
  
  
  

<div class="comments" id="comments">
  
  
  <div id="vcomments" class="vcomments"></div>
  <script defer src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
  <script defer src="//unpkg.com/valine/dist/Valine.min.js"></script>
  <script type="text/javascript">
  $(document).ready(function () {
    new Valine({
      "el": "#vcomments",
      "appId": "kRqMnbmUujwPVMH3Qqo272g2-gzGzoHsz",
      "appKey": "vJuJTznw3VXLJwd5YYu3Q9HF",
      "verify": "false",
      "notify": "false",
      "avatar": "mm",
      "meta": ["nick", "mail", "link"],
      "pageSize": 10,
      "lang": "zh-cn",
      "visitor": "false",
      "highlight": "true",
      "placeholder": "åœ¨è¿™é‡Œè¯´ç‚¹ä»€ä¹ˆâ€¦â€¦",
      "avatarForce": "false"
    });
  });
  </script>
  
  
</div>



  
</div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="æœç´¢" class="form-control">
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/blog.jpg" alt="å˜¤å˜¤æ€ª&&ğŸ¶">
  
  <h1 class="author-name">å˜¤å˜¤æ€ª&&ğŸ¶</h1>
  <h2 class="author-description"></h2>
  <div class="site-count">
    
    
    
    
    <div class="archives-count count-block">
      <div class="site-count-title">å½’æ¡£</div>
      <div><a href="/archives/">9</a></div>
    </div>
    
    
  </div>
  
  <div class="rss">
    <a class="rss-link button sidebar-item" href="/atom.xml"><i class="fas fa-rss"></i>RSS</a>
  </div>
  
</div>


  <div class="sidebar-sticky">
    
    
    
    
    
    <hr>
    <div class="post-toc sidebar-item" id="toc-div">
      <div><i class="fas fa-list-ol"></i>æ–‡ç« ç›®å½•</div>
      <div class="post-toc-content"><ol class="list-group toc"><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#MySQLæŸ¥è¯¢ä¼˜åŒ–"><span class="toc-text">MySQLæŸ¥è¯¢ä¼˜åŒ–</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#inä¸exists"><span class="toc-text">inä¸exists</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#order-byå…³é”®å­—ä¼˜åŒ–"><span class="toc-text">order byå…³é”®å­—ä¼˜åŒ–</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#group-byå…³é”®å­—ä¼˜åŒ–"><span class="toc-text">group byå…³é”®å­—ä¼˜åŒ–</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="list-group-item toc-link" href="#show-profileçš„ä½¿ç”¨"><span class="toc-text">show profileçš„ä½¿ç”¨</span></a><ol class="list-group toc-child"><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·"><span class="toc-text">æ…¢æŸ¥è¯¢çš„å¼€å¯å¹¶æ•è·</span></a></li><li class="toc-item toc-level-3"><a class="list-group-item toc-link" href="#ä½¿ç”¨show-profile"><span class="toc-text">ä½¿ç”¨show profile</span></a></li></ol></li></ol></div>
    </div>
    
    
    
    <hr>
    <div class="social-link sidebar-item">
      <div><i class="far fa-address-card"></i>ç¤¾äº¤é“¾æ¥<p></p></div>
      <ul>
        
        <li><i class="fas fa-envelope"></i><a href="mailto:1176924360@qq.com" target="_blank">E-Mail</a></li>
        
        <li><i class="fab fa-github"></i><a href="https://github.com/cdvsdsa" target="_blank">cdvsdsa</a></li>
        
        <li><i class="fab fa-weibo"></i><a href="https://weibo.com/u/3967811493" target="_blank">ä¸æ˜¯äººæ°‘çš„å¥½æ¦œæ ·</a></li>
        
      </ul>
    </div>
    
    
    <hr>
    <div class="blogroll sidebar-item">
      <div><i class="fas fa-link"></i>å‹æƒ…é“¾æ¥</div>
      <ul>
        
        <li><i class="fas fa-link"></i><a href="https://github.com/" target="_blank">GitHub</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://developer.mozilla.org/" target="_blank">MDN</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://mozilla.github.io/nunjucks/" target="_blank">Nunjucks</a></li>
        
      </ul>
    </div>
    
  </div>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="å›åˆ°é¡¶éƒ¨"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author">å˜¤å˜¤æ€ª&&ğŸ¶</span><span class="year"><i class="far fa-copyright"></i>2019 - 2019</span>
        </div>
        
        <div class="busuanzi">
          <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="ç«™ç‚¹ç‚¹å‡»é‡" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="ç«™ç‚¹ç”¨æˆ·æ•°" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="far fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="é¡µé¢ç‚¹å‡»é‡" aria-hidden="false"></span></span>
        </div>
        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          æ‰˜ç®¡äº<i class="fab fa-github-alt"></i><a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
          
        </div>
        <div class="powered-by">
          ç”± <a href="https://hexo.io/" target="_blank">Hexo</a> å¼ºåŠ›é©±åŠ¨ | ä¸»é¢˜ <a href="https://github.com/AlynxZhou/hexo-theme-aria/" target="_blank">ARIA</a>
        </div>
      </div>
    </div>
  </div>
</footer>


  </body>
</html>
